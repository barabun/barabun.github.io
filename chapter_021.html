<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html>
<html epub:prefix="z3998: http://www.daisy.org/z3998/2012/vocab/structure/#" lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
 <head>
  <link href="style.css" rel="stylesheet" type="text/css"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   13
  </title>
 </head>
 <body>
  <div class="navigation">
   <a class="nav-button" href="chapter_020.html">
    ← Previous
   </a>
   <a class="nav-button" href="index.html">
    Table of Contents
   </a>
   <a class="nav-button" href="chapter_022.html">
    Next →
   </a>
  </div>
  <div class="chapter-content">
   <div class="calibre2" id="_idContainer240">
    <h1 class="chapter-number" id="_idParaDest-265">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor265">
     </a>
     13
    </h1>
    <h1 class="calibre5" id="_idParaDest-266">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor266">
     </a>
     Developing Web Applications Using Qt WebEngine
    </h1>
    <p class="calibre3">
     Qt includes a module called
     <strong class="bold">
      Qt WebEngine
     </strong>
     that allows us to embed a web browser widget into our program and use it to display web pages or local HTML content. Prior to version 5.6, Qt used another similar module called
     <strong class="bold">
      Qt WebKit
     </strong>
     , which is now deprecated and has since been replaced by the Chromium-based
     <strong class="bold">
      WebEngine
     </strong>
     module. Qt also allows communication between JavaScript and C++ code through
     <strong class="bold">
      Qt WebChannel
     </strong>
     , which enables us to make use of this module in a much more
     <span>
      effective fashion.
     </span>
    </p>
    <p class="calibre3">
     In this chapter, we will cover the
     <span>
      following recipes:
     </span>
    </p>
    <ul class="calibre15">
     <li class="calibre14">
      Introducing
      <span>
       <strong class="bold">
        Qt WebEngine
       </strong>
      </span>
     </li>
     <li class="calibre14">
      Using
      <strong class="source-inline1">
       webview
      </strong>
      and
      <span>
       web settings
      </span>
     </li>
     <li class="calibre14">
      Embedding Google maps in
      <span>
       your project
      </span>
     </li>
     <li class="calibre14">
      Calling C++ functions
      <span>
       from JavaScript
      </span>
     </li>
     <li class="calibre14">
      Calling JavaScript functions
      <span>
       from C++
      </span>
     </li>
    </ul>
    <h1 class="calibre5" id="_idParaDest-267">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor267">
     </a>
     Technical requirements
    </h1>
    <p class="calibre3">
     The technical requirements for this chapter include Qt 6.6.1 MSVC 2019 64 bit, Qt Creator 12.0.2, and Microsoft Visual Studio. All the code used in this chapter can be downloaded from the following GitHub
     <span>
      repository:
     </span>
     <a class="pcalibre pcalibre1 calibre6" href="https://github.com/PacktPublishing/QT6-C-GUI-Programming-Cookbook---Third-Edition-/tree/main/Chapter13">
      <span>
       https://github.com/PacktPublishing/QT6-C-GUI-Programming-Cookbook---Third-Edition-/tree/main/Chapter13
      </span>
     </a>
     <span>
      .
     </span>
    </p>
    <h1 class="calibre5" id="_idParaDest-268">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor268">
     </a>
     Introducing Qt WebEngine
    </h1>
    <p class="calibre3">
     In this example project, we will explore the basic features of the
     <strong class="bold">
      WebEngine
     </strong>
     module in Qt and try building a simple working web browser. Since Qt 5.6, Qt’s
     <strong class="bold">
      WebKit
     </strong>
     module has been deprecated and
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker832">
     </a>
     replaced by the
     <strong class="bold">
      WebEngine
     </strong>
     module, which is based on Google’s
     <span>
      Chromium engine.
     </span>
    </p>
    <h2 class="calibre7" id="_idParaDest-269">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor269">
     </a>
     How to do it…
    </h2>
    <p class="calibre3">
     First, let’s set up our
     <span>
      <strong class="bold">
       WebEngine
      </strong>
     </span>
     <span>
      project:
     </span>
    </p>
    <ol class="calibre13">
     <li class="calibre14">
      At the moment, Qt’s
      <strong class="bold">
       WebEngine
      </strong>
      module only
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker833">
      </a>
      works with the Visual C++ compiler and not
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker834">
      </a>
      others, such as
      <strong class="bold">
       MinGW
      </strong>
      or
      <strong class="bold">
       Cygwin
      </strong>
      . This might change in the future, but it all depends
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker835">
      </a>
      on whether Qt developers want to port it to other compilers or not. Make sure that the Qt version you installed on your computer supports the Visual C++ compiler. You can add the
      <strong class="bold">
       MSVC 2019 64-bit
      </strong>
      component to your Qt installation using Qt’s maintenance tool. Also, make sure that you have installed the
      <strong class="bold">
       Qt WebEngine
      </strong>
      component in your
      <span>
       Qt version:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer218">
      <img alt="Figure 13.1 – Making sure MSVC 2019 and Qt WebEngine are installed" class="calibre4" src="image/B20976_13_001.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.1 – Making sure MSVC 2019 and Qt WebEngine are installed
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="2">
      Open up Qt Creator and
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker836">
      </a>
      create a new
      <strong class="bold">
       Qt Widgets Application
      </strong>
      project. Select a kit that uses the Visual
      <span>
       C++ compiler:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer219">
      <img alt="Figure 13.2 – Only MSVC is officially supported by Qt WebEngine" class="calibre4" src="image/B20976_13_002.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.2 – Only MSVC is officially supported by Qt WebEngine
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="3">
      Open up your project file (
      <strong class="source-inline1">
       .pro
      </strong>
      ) and add the following modules to your project. After that, you must run
      <strong class="source-inline1">
       qmake
      </strong>
      to apply
      <span>
       the changes:
      </span>
      <pre class="source-code">
QT += core gui <strong class="bold1">webenginewidgets</strong></pre>
     </li>
     <li class="calibre14">
      Open up
      <strong class="source-inline1">
       mainwindow.ui
      </strong>
      and
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker837">
      </a>
      remove the
      <strong class="bold">
       menuBar
      </strong>
      ,
      <strong class="bold">
       mainToolBar
      </strong>
      , and
      <strong class="bold">
       statusBar
      </strong>
      objects, as we don’t need those in
      <span>
       this project:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer220">
      <img alt="Figure 13.3 – Removing the menu bar, main toolbar, and status bar" class="calibre4" src="image/B20976_13_003.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.3 – Removing the menu bar, main toolbar, and status bar
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="5">
      Place two horizontal layouts on the canvas, then place a
      <strong class="bold">
       Line Edit
      </strong>
      widget and a push button for the layout at
      <span>
       the top:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer221">
      <img alt="Figure 13.4 – Placing the line edit widget and push button in a layout" class="calibre4" src="image/B20976_13_004.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.4 – Placing the line edit widget and push button in a layout
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="6">
      Select the canvas and click on the
      <strong class="bold">
       Lay Out Vertically
      </strong>
      button located at the top of
      <span>
       the editor:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer222">
      <img alt="Figure 13.5 – Clicking on the Lay Out Vertically button" class="calibre4" src="image/B20976_13_005.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.5 – Clicking on the Lay Out Vertically button
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="7">
      The layouts will expand and
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker838">
      </a>
      follow the size of the main window. The line edit will also expand horizontally, based on the width of the
      <span>
       horizontal layout:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer223">
      <img alt="Figure 13.6 – The line edit is now expanding horizontally" class="calibre4" src="image/B20976_13_006.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.6 – The line edit is now expanding horizontally
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="8">
      Add two buttons to the left side of the line edit. We’ll use these two buttons to move backward and forward between page histories. Add a
      <strong class="bold">
       Progress Bar
      </strong>
      widget at the bottom of the main window so that we can find out whether the page has finished loading or is still in progress. We don’t have to worry about the horizontal layout in the middle at this point as we’ll be adding
      <strong class="source-inline1">
       webview
      </strong>
      to it later at
      <em class="italic">
       step 15
      </em>
      using C++ code, and the space will
      <span>
       be occupied:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer224">
      <img alt="Figure 13.7 – Adding two more buttons and a progress bar to the UI" class="calibre4" src="image/B20976_13_007.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.7 – Adding two more buttons and a progress bar to the UI
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="9">
      Right-click on one of the buttons
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker839">
      </a>
      and select
      <strong class="bold">
       Go to slot…
      </strong>
      , then select
      <strong class="source-inline1">
       clicked()
      </strong>
      and click
      <strong class="bold">
       OK
      </strong>
      . A slot function will be automatically created for you in
      <strong class="source-inline1">
       mainwindow.h
      </strong>
      and
      <strong class="source-inline1">
       mainwindow.cpp
      </strong>
      . Repeat this step for all the other buttons
      <span>
       as well.
      </span>
     </li>
     <li class="calibre14">
      Right-click on the line edit and select
      <strong class="bold">
       Go to slot…
      </strong>
      , then select
      <strong class="source-inline1">
       returnPressed()
      </strong>
      and click
      <strong class="bold">
       OK
      </strong>
      . Another slot function will now be automatically created for you in
      <strong class="source-inline1">
       mainwindow.h
      </strong>
      <span>
       and
      </span>
      <span>
       <strong class="source-inline1">
        mainwindow.cpp
       </strong>
      </span>
      <span>
       .
      </span>
     </li>
     <li class="calibre14">
      Let’s hop over to
      <strong class="source-inline1">
       mainwindow.h
      </strong>
      . The first thing we need to do is to add the following header
      <span>
       to
      </span>
      <span>
       <strong class="source-inline1">
        mainwindow.h
       </strong>
      </span>
      <span>
       :
      </span>
      <pre class="source-code">
#include &lt;QtWebEngineWidgets/QtWebEngineWidgets&gt;</pre>
     </li>
     <li class="calibre14">
      Declare a
      <strong class="source-inline1">
       loadUrl()
      </strong>
      function under the
      <span>
       class destructor:
      </span>
      <pre class="source-code">
public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();
    <strong class="bold1">void loadUrl();</strong></pre>
     </li>
     <li class="calibre14">
      Add a custom slot function called
      <strong class="source-inline1">
       loading()
      </strong>
      <span>
       to
      </span>
      <span>
       <strong class="source-inline1">
        mainwindow.h
       </strong>
      </span>
      <span>
       :
      </span>
      <pre class="source-code">
private slots:
    void on_goButton_clicked();
    void on_address_returnPressed();
    void on_backButton_clicked();
    void on_forwardButton_clicked();
    void loading(int progress);</pre>
     </li>
     <li class="calibre14">
      Declare a
      <strong class="source-inline1">
       QWebEngineView
      </strong>
      object and call
      <span>
       it
      </span>
      <span>
       <strong class="source-inline1">
        webview
       </strong>
      </span>
      <span>
       :
      </span>
      <pre class="source-code">
private:
    Ui::MainWindow *ui;
    QWebEngineView* webview;</pre>
     </li>
     <li class="calibre14">
      Open the
      <strong class="source-inline1">
       mainwindow.cpp
      </strong>
      file and initiate the
      <strong class="source-inline1">
       WebEngine
      </strong>
      view. Add it to the second horizontal layout and connect its
      <strong class="source-inline1">
       loadProgress()
      </strong>
      signal to the
      <strong class="source-inline1">
       loading()
      </strong>
      slot function
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker840">
      </a>
      we just added
      <span>
       to
      </span>
      <span>
       <strong class="source-inline1">
        mainwindow.h
       </strong>
      </span>
      <span>
       :
      </span>
      <pre class="source-code">
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui-&gt;setupUi(this);
    <strong class="bold1">webview = new QWebEngineView;</strong>
    <strong class="bold1">ui-&gt;horizontalLayout_2-&gt;addWidget(webview);</strong>
    <strong class="bold1">connect(webview, &amp;QWebEngineView::loadProgress, this,</strong>
<strong class="bold1">&amp;MainWindow::loading);</strong>
}</pre>
     </li>
     <li class="calibre14">
      Declare what will happen when the
      <strong class="source-inline1">
       loadUrl()
      </strong>
      function
      <span>
       is called:
      </span>
      <pre class="source-code">
void MainWindow::loadUrl() {
    QUrl url = QUrl(ui-&gt;address-&gt;text());
    url.setScheme("http");
    webview-&gt;page()-&gt;load(url);
}</pre>
     </li>
     <li class="calibre14">
      Call the
      <strong class="source-inline1">
       loadUrl()
      </strong>
      function
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker841">
      </a>
      when the
      <strong class="bold">
       Go
      </strong>
      button is clicked or when the
      <em class="italic">
       Enter
      </em>
      key
      <span>
       is pressed:
      </span>
      <pre class="source-code">
void MainWindow::on_goButton_clicked() {
    loadUrl();
}
MainWindow::on_address_returnPressed() {
    loadUrl();
}</pre>
     </li>
     <li class="calibre14">
      As for the other two buttons, we’ll ask
      <strong class="source-inline1">
       webview
      </strong>
      to load the previous page or the next page if it is available in the
      <span>
       history stack:
      </span>
      <pre class="source-code">
void MainWindow::on_backButton_clicked() {
    webview-&gt;back();
}
void MainWindow::on_forwardButton_clicked() {
    webview-&gt;forward();
}</pre>
     </li>
     <li class="calibre14">
      Change the value of
      <strong class="source-inline1">
       progressBar
      </strong>
      when the web page is
      <span>
       being loaded:
      </span>
      <pre class="source-code">
void MainWindow::loading(int progress) {
    ui-&gt;progressBar-&gt;setValue(progress);
}</pre>
     </li>
     <li class="calibre14">
      Build and run the program now, and you will get a very basic but functional
      <span>
       web browser:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer225">
      <img alt="Figure 13.8 – We have created a simple web browser from scratch!" class="calibre4" src="image/B20976_13_008.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.8 – We have created a simple web browser from scratch!
    </p>
    <h2 class="calibre7" id="_idParaDest-270">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor270">
     </a>
     How it works…
    </h2>
    <p class="calibre3">
     The old
     <strong class="source-inline">
      webview
     </strong>
     system was
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker842">
     </a>
     based on Apple’s
     <strong class="bold">
      WebKit
     </strong>
     engine and is only available in Qt 5.5 and its predecessor. Since 5.6,
     <strong class="bold">
      WebKit
     </strong>
     has been completely abandoned by Qt and replaced with Google’s
     <strong class="bold">
      Chromium
     </strong>
     engine. The API has been completely changed, and therefore all the code related to
     <strong class="bold">
      Qt WebKit
     </strong>
     will not work correctly once migrated to 5.6. If you’re new to Qt, it’s recommended you skip
     <strong class="bold">
      WebKit
     </strong>
     and learn the
     <strong class="bold">
      WebEngine
     </strong>
     API since it is becoming the new standard
     <span>
      in Qt.
     </span>
    </p>
    <p class="callout-heading">
     Note
    </p>
    <p class="callout">
     If you have used Qt’s
     <strong class="bold">
      WebKit
     </strong>
     in the past, this web page teaches you how to port your old code over to
     <span>
      <strong class="bold">
       WebEngine
      </strong>
     </span>
     <span>
      :
     </span>
     <a class="pcalibre pcalibre1 calibre6" href="https://wiki.qt.io/Porting_from_QtWebKit_to_QtWebEngine">
      <span>
       https://wiki.qt.io/Porting_from_QtWebKit_to_QtWebEngine
      </span>
     </a>
    </p>
    <p class="calibre3">
     In
     <em class="italic">
      step 15
     </em>
     in the previous section, we connected the
     <strong class="source-inline">
      loadProgress()
     </strong>
     signal that belongs to the
     <strong class="source-inline">
      webview
     </strong>
     widget to the
     <strong class="source-inline">
      loading()
     </strong>
     slot function. The signal will be called automatically when
     <strong class="source-inline">
      webview
     </strong>
     is loading the web page you requested by calling
     <strong class="source-inline">
      QWebEnginePage::load()
     </strong>
     in
     <em class="italic">
      step 17
     </em>
     . You can also connect the
     <strong class="source-inline">
      loadStarted()
     </strong>
     and
     <strong class="source-inline">
      loadFinished()
     </strong>
     signals if you
     <span>
      need to.
     </span>
    </p>
    <p class="calibre3">
     In
     <em class="italic">
      step 17
     </em>
     , we used the
     <strong class="source-inline">
      QUrl
     </strong>
     class to convert the text obtained from the line edit to URL format. By default, the address we inserted will lead to the local path if we do not specify the URL scheme (HTTP, HTTPS, FTP, and so on). We may not be able to load the page if, say, we gave it
     <strong class="source-inline">
      google.com
     </strong>
     instead of
     <strong class="source-inline">
      http://google.com
     </strong>
     . Therefore, we manually specified a URL scheme for it by calling
     <strong class="source-inline">
      QUrl::setScheme()
     </strong>
     . This ensured the address is
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker843">
     </a>
     properly formatted before passing it
     <span>
      to
     </span>
     <span>
      <strong class="source-inline">
       webview
      </strong>
     </span>
     <span>
      .
     </span>
    </p>
    <h2 class="calibre7" id="_idParaDest-271">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor271">
     </a>
     There’s more…
    </h2>
    <p class="calibre3">
     If for some reason you need the
     <strong class="bold">
      WebKit
     </strong>
     module for your project instead of
     <strong class="bold">
      WebEngine
     </strong>
     , you can obtain the module code from GitHub and build it by
     <span>
      yourself:
     </span>
     <a class="pcalibre pcalibre1 calibre6" href="https://github.com/qt/qtwebkit">
      <span>
       https://github.com/qt/qtwebkit
      </span>
     </a>
    </p>
    <h1 class="calibre5" id="_idParaDest-272">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor272">
     </a>
     Using webview and web settings
    </h1>
    <p class="calibre3">
     In this recipe, we will dive deeper into the features available in Qt’s
     <strong class="bold">
      WebEngine
     </strong>
     module and explore the settings that we can use to customize our
     <strong class="source-inline">
      webview
     </strong>
     . We will use the source files from the
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker844">
     </a>
     previous example and add more
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker845">
     </a>
     code
     <span>
      to it.
     </span>
    </p>
    <h2 class="calibre7" id="_idParaDest-273">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor273">
     </a>
     How to do it…
    </h2>
    <p class="calibre3">
     Let’s explore some of the
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker846">
     </a>
     basic features of the
     <strong class="bold">
      Qt
     </strong>
     <span>
      <strong class="bold">
       WebEngine
      </strong>
     </span>
     <span>
      module:
     </span>
    </p>
    <ol class="calibre13">
     <li class="calibre14">
      Open
      <strong class="source-inline1">
       mainwindow.ui
      </strong>
      and
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker847">
      </a>
      add a vertical layout under the progress bar. Add a
      <strong class="bold">
       Plain Text Edit
      </strong>
      widget (under the
      <strong class="bold">
       Input Widgets
      </strong>
      category) and a push button to the vertical layout. Change the display of the push button to
      <strong class="bold">
       Load HTML
      </strong>
      and set the
      <strong class="source-inline1">
       plaintext
      </strong>
      property of the
      <strong class="bold">
       Plain Text Edit
      </strong>
      widget to
      <span>
       the following:
      </span>
      <pre class="source-code">
&lt;Img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png"&gt;&lt;/img&gt;
&lt;h1&gt;Hello World!&lt;/h1&gt;
&lt;h3&gt;This is our custom HTML page.&lt;/h3&gt;
&lt;script&gt;alert("Hello!");&lt;/script&gt;</pre>
      <p class="calibre3">
       This is how it should look after
       <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker848">
       </a>
       you have added the code
       <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker849">
       </a>
       on top of the
       <strong class="bold">
        Plain Text
       </strong>
       <span>
        <strong class="bold">
         Edit
        </strong>
       </span>
       <span>
        widget:
       </span>
      </p>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer226">
      <img alt="Figure 13.9 – Adding a Plain Text Edit widget and a push button to the bottom" class="calibre4" src="image/B20976_13_009.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.9 – Adding a Plain Text Edit widget and a push button to the bottom
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="2">
      Go to
      <strong class="bold">
       File
      </strong>
      |
      <strong class="bold">
       New File
      </strong>
      . A
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker850">
      </a>
      window will pop up and ask you to choose
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker851">
      </a>
      a file template. Select
      <strong class="bold">
       Qt Resource File
      </strong>
      under the
      <strong class="bold">
       Qt
      </strong>
      category and click on the
      <strong class="bold">
       Choose…
      </strong>
      button. Type in your desired filename and click
      <strong class="bold">
       Next
      </strong>
      , followed
      <span>
       by
      </span>
      <span>
       <strong class="bold">
        Finish
       </strong>
      </span>
      <span>
       :
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer227">
      <img alt="Figure 13.10 – Creating a Qt resource file" class="calibre4" src="image/B20976_13_010.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.10 – Creating a Qt resource file
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="3">
      Open the resource file
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker852">
      </a>
      we just created by right-clicking on it in the
      <strong class="bold">
       Projects
      </strong>
      pane and selecting the
      <strong class="bold">
       Open in Editor
      </strong>
      option. Once the
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker853">
      </a>
      file is opened by the editor, click on the
      <strong class="bold">
       Add
      </strong>
      button, followed by
      <strong class="bold">
       Add Prefix
      </strong>
      . Set the prefix as
      <strong class="source-inline1">
       /
      </strong>
      and click
      <strong class="bold">
       Add
      </strong>
      , followed
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker854">
      </a>
      by
      <strong class="bold">
       Add Files
      </strong>
      . A file browser window will
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker855">
      </a>
      appear, and we will select the
      <strong class="source-inline1">
       tux.png
      </strong>
      image file and click
      <strong class="bold">
       Open
      </strong>
      . The image file is now added to our project, where it will be embedded into the executable file (
      <strong class="source-inline1">
       .exe
      </strong>
      ) once
      <span>
       it’s compiled:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer228">
      <img alt="Figure 13.11 – Adding the tux.png image file to our resource file" class="calibre4" src="image/B20976_13_011.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.11 – Adding the tux.png image file to our resource file
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="4">
      Open
      <strong class="source-inline1">
       mainwindow.h
      </strong>
      and add
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker856">
      </a>
      the following headers
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker857">
      </a>
      <span>
       to it:
      </span>
      <pre class="source-code">
#include &lt;QMainWindow&gt;
<strong class="bold1">#include &lt;QtWebEngineWidgets/QtWebEngineWidgets&gt;</strong>
<strong class="bold1">#include &lt;QDebug&gt;</strong>
<strong class="bold1">#include &lt;QFile&gt;</strong></pre>
     </li>
     <li class="calibre14">
      Make sure the following functions and
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker858">
      </a>
      pointers have been
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker859">
      </a>
      declared
      <span>
       in
      </span>
      <span>
       <strong class="source-inline1">
        mainwindow.h
       </strong>
      </span>
      <span>
       :
      </span>
      <pre class="source-code">
public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();
    <strong class="bold1">void loadUrl();</strong>
private slots:
    <strong class="bold1">void on_goButton_clicked();</strong>
    <strong class="bold1">void on_address_returnPressed();</strong>
    <strong class="bold1">void on_backButton_clicked();</strong>
    <strong class="bold1">void on_forwardButton_clicked();</strong>
    <strong class="bold1">void startLoading();</strong>
    <strong class="bold1">void loading(int progress);</strong>
    <strong class="bold1">void loaded(bool ok);</strong>
    <strong class="bold1">void on_loadHtml_clicked();</strong>
private:
    Ui::MainWindow *ui;
    <strong class="bold1">QWebEngineView* webview;</strong></pre>
     </li>
     <li class="calibre14">
      Open
      <strong class="source-inline1">
       mainwindow.cpp
      </strong>
      and
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker860">
      </a>
      add the following
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker861">
      </a>
      code to the
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker862">
      </a>
      <span>
       class
      </span>
      <span>
       <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker863">
       </a>
      </span>
      <span>
       constructor:
      </span>
      <pre class="source-code">
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui-&gt;setupUi(this);
    <strong class="bold1">webview = new QWebEngineView;</strong>
    <strong class="bold1">ui-&gt;horizontalLayout_2-&gt;addWidget(webview);</strong>
   <strong class="bold1">//webview-&gt;page()-&gt;settings()-&gt;setAttribute(QWebEngineSettings::JavascriptEnabled, false);</strong>
   <strong class="bold1">//webview-&gt;page()-&gt;settings()-&gt;setAttribute(QWebEngineSettings::AutoLoadImages, false);</strong>
   <strong class="bold1">//QString fontFamily = webview-&gt;page()-&gt;settings()-&gt;fontFamily(QWebEngineSettings::SerifFont);</strong>
    <strong class="bold1">QString fontFamily = webview-&gt;page()-&gt;settings()-&gt;fontFamily(QWebEngineSettings::SansSerifFont);</strong>
    <strong class="bold1">int fontSize = webview-&gt;page()-&gt;settings()-&gt;fontSize(QWebEngineSettings::MinimumFontSize);</strong>
    <strong class="bold1">QFont myFont = QFont(fontFamily, fontSize);</strong>
    <strong class="bold1">webview-&gt;page()-&gt;settings()-&gt;setFontFamily(QWebEngineSettings::StandardFont, myFont.family());</strong></pre>
     </li>
     <li class="calibre14">
      Load the
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker864">
      </a>
      image file and
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker865">
      </a>
      place it
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker866">
      </a>
      <span>
       on
      </span>
      <span>
       <strong class="source-inline1">
        webview
       </strong>
      </span>
      <span>
       :
      </span>
      <pre class="source-code">
    QFile file("://tux.png");
    if (file.open(QFile::ReadOnly)) {
        QByteArray data = file.readAll();
        webview-&gt;page()-&gt;setContent(data, "image/png");
    }
    else {
        qDebug() &lt;&lt; "File cannot be opened.";
    }
    connect(webview, &amp;QWebEngineView::loadStarted, this, &amp;MainWindow::startLoading()));
    connect(webview, &amp;QWebEngineView::loadProgress, this, &amp;MainWindow::loading(int)));
    connect(webview, &amp;QWebEngineView::loadFinished, this, &amp;MainWindow::loaded(bool)));
}</pre>
     </li>
     <li class="calibre14">
      The
      <strong class="source-inline1">
       MainWindow::loadUrl()
      </strong>
      function stays the same as in the previous example in the
      <em class="italic">
       Introducing Qt WebEngine
      </em>
      recipe, which sets the URL scheme to HTTP before loading
      <span>
       the
      </span>
      <span>
       <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker867">
       </a>
      </span>
      <span>
       page:
      </span>
      <pre class="source-code">
void MainWindow::loadUrl() {
    QUrl url = QUrl(ui-&gt;address-&gt;text());
    url.setScheme("http");
    webview-&gt;page()-&gt;load(url);
}</pre>
     </li>
     <li class="calibre14">
      The same goes for the
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker868">
      </a>
      following functions, which also
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker869">
      </a>
      remain the same as the previous example
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker870">
      </a>
      in the
      <em class="italic">
       Introducing Qt
      </em>
      <span>
       <em class="italic">
        WebEngine
       </em>
      </span>
      <span>
       recipe:
      </span>
      <pre class="source-code">
void MainWindow::on_goButton_clicked() {
    loadUrl();
}
void MainWindow::on_address_returnPressed() {
    loadUrl();
}
void MainWindow::on_backButton_clicked() {
    webview-&gt;back();
}
void MainWindow::on_forwardButton_clicked() {
    webview-&gt;forward();
}</pre>
     </li>
     <li class="calibre14">
      Add the
      <strong class="source-inline1">
       MainWindow::startLoading()
      </strong>
      and
      <strong class="source-inline1">
       MainWindow::loaded()
      </strong>
      slot functions, which will be called by the
      <strong class="source-inline1">
       loadStarted()
      </strong>
      and
      <strong class="source-inline1">
       loadFinished()
      </strong>
      signals. These two functions basically show a progress bar when
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker871">
      </a>
      a page is starting to load and hide the progress bar
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker872">
      </a>
      when the page has
      <span>
       finished loading:
      </span>
      <pre class="source-code">
void MainWindow::startLoading() {
    ui-&gt;progressBar-&gt;show();
}
void MainWindow::loading(int progress) {
    ui-&gt;progressBar-&gt;setValue(progress);
}
void MainWindow::loaded(bool ok) {
    ui-&gt;progressBar-&gt;hide();
}</pre>
     </li>
     <li class="calibre14">
      Call
      <strong class="source-inline1">
       webview-&gt;loadHtml()
      </strong>
      to convert
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker873">
      </a>
      the plain text to HTML
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker874">
      </a>
      content when the
      <strong class="bold">
       Load HTML
      </strong>
      button
      <span>
       is clicked:
      </span>
      <pre class="source-code">
void MainWindow::on_loadHtml_clicked() {
    webview-&gt;setHtml(ui-&gt;source-&gt;toPlainText());
}</pre>
     </li>
     <li class="calibre14">
      Build and run the program, and you should see something like
      <span>
       the following:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer229">
      <img alt="Figure 13.12 –webview will now display the result generated from your HTML code" class="calibre4" src="image/B20976_13_012.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.12 –webview will now display the result generated from your HTML code
    </p>
    <h2 class="calibre7" id="_idParaDest-274">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor274">
     </a>
     How it works…
    </h2>
    <p class="calibre3">
     In this example, we used C++ to load an image
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker875">
     </a>
     file and set it as
     <strong class="source-inline">
      webview
     </strong>
     default content (instead of a blank page). We
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker876">
     </a>
     could
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker877">
     </a>
     achieve the same result by loading a default HTML file with an image
     <span>
      at startup.
     </span>
    </p>
    <p class="calibre3">
     Some of the code in the class constructor has been commented out. You can remove the double slashes (
     <strong class="source-inline">
      //
     </strong>
     ) and see the difference it makes – the JavaScript alert will no longer appear (since JavaScript
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker878">
     </a>
     is disabled) and images will no longer appear in
     <span>
      your
     </span>
     <span>
      <strong class="source-inline">
       webview
      </strong>
     </span>
     <span>
      .
     </span>
    </p>
    <p class="calibre3">
     Another thing you can try is to change the font family from
     <strong class="source-inline">
      QWebEngineSettings::SansSerifFont
     </strong>
     to
     <strong class="source-inline">
      QWebEngineSettings::SerifFont
     </strong>
     . You will notice a slight difference in the font as it appears
     <span>
      in
     </span>
     <span>
      <strong class="source-inline">
       webview
      </strong>
     </span>
     <span>
      :
     </span>
    </p>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer230">
      <img alt="Figure 13.13 – Different types of font showing in webview" class="calibre4" src="image/B20976_13_013.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.13 – Different types of font showing in webview
    </p>
    <p class="calibre3">
     By clicking the
     <strong class="bold">
      Load HTML
     </strong>
     button, we
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker879">
     </a>
     ask
     <strong class="source-inline">
      webview
     </strong>
     to treat the content of the
     <strong class="bold">
      Plain Text Edit
     </strong>
     widget as HTML code
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker880">
     </a>
     and load it as an HTML page. You can use this to make a simple HTML editor powered
     <span>
      by Qt!
     </span>
    </p>
    <h1 class="calibre5" id="_idParaDest-275">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor275">
     </a>
     Embedding Google maps in your project
    </h1>
    <p class="calibre3">
     In this recipe, we will learn how to embed Google maps in our project through Qt’s
     <strong class="bold">
      WebEngine
     </strong>
     module. This
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker881">
     </a>
     example doesn’t focus much on Qt and C++, but rather on the
     <strong class="bold">
      Google Maps
     </strong>
     API in
     <span>
      HTML code.
     </span>
    </p>
    <h2 class="calibre7" id="_idParaDest-276">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor276">
     </a>
     How to do it…
    </h2>
    <p class="calibre3">
     Let’s create a program that displays Google maps by following
     <span>
      these steps:
     </span>
    </p>
    <ol class="calibre13">
     <li class="calibre14">
      Create a new
      <strong class="bold">
       Qt Widgets Application
      </strong>
      project and remove the
      <strong class="bold">
       statusBar
      </strong>
      ,
      <strong class="bold">
       menuBar
      </strong>
      , and
      <span>
       <strong class="bold">
        mainToolBar
       </strong>
      </span>
      <span>
       objects.
      </span>
     </li>
     <li class="calibre14">
      Open your project file (
      <strong class="source-inline1">
       .pro
      </strong>
      ) and add the following modules to
      <span>
       your project:
      </span>
      <pre class="source-code">
QT += core gui webenginewidgets</pre>
     </li>
     <li class="calibre14">
      Open
      <strong class="source-inline1">
       mainwindow.ui
      </strong>
      and add a vertical layout to the canvas. Then, select the canvas and click
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker882">
      </a>
      the
      <strong class="bold">
       Lay Out Vertically
      </strong>
      button on top of the canvas. You will get
      <span>
       the following:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer231">
      <img alt="Figure 13.14 – Adding a vertical layout to the central widget" class="calibre4" src="image/B20976_13_014.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.14 – Adding a vertical layout to the central widget
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="4">
      Open
      <strong class="source-inline1">
       mainwindow.cpp
      </strong>
      and add the following header to the top of the
      <span>
       source code:
      </span>
      <pre class="source-code">
#include &lt;QtWebEngineWidgets/QWebEngineView&gt;</pre>
     </li>
     <li class="calibre14">
      Add the following code to the
      <span>
       <strong class="source-inline1">
        MainWindow
       </strong>
      </span>
      <span>
       constructor:
      </span>
      <pre class="source-code">
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui-&gt;setupUi(this);
    <strong class="bold1">QWebEngineView* webview = new QWebEngineView;</strong>
    <strong class="bold1">QUrl url = QUrl("qrc:/map.html");</strong>
    <strong class="bold1">webview-&gt;page()-&gt;load(url);</strong>
    <strong class="bold1">ui-&gt;verticalLayout-&gt;addWidget(webview);</strong>
}</pre>
     </li>
     <li class="calibre14">
      Go to
      <strong class="bold">
       File
      </strong>
      |
      <strong class="bold">
       New File
      </strong>
      and create a Qt resource file (
      <strong class="source-inline1">
       .qrc
      </strong>
      ). We will add an HTML file to our project,
      <span>
       called
      </span>
      <span>
       <strong class="source-inline1">
        map.html
       </strong>
      </span>
      <span>
       :
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer232">
      <img alt="Figure 13.15 – Adding map.html to the resource file" class="calibre4" src="image/B20976_13_015.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.15 – Adding map.html to the resource file
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="7">
      Open
      <strong class="source-inline1">
       map.html
      </strong>
      with your favorite text editor. It’s not recommended to open an HTML file using Qt
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker883">
      </a>
      Creator as it does not provide any color coding for
      <span>
       HTML syntax.
      </span>
     </li>
     <li class="calibre14">
      Start writing the HTML code by declaring important tags, such as
      <strong class="source-inline1">
       &lt;html&gt;
      </strong>
      ,
      <strong class="source-inline1">
       &lt;head&gt;
      </strong>
      ,
      <span>
       and
      </span>
      <span>
       <strong class="source-inline1">
        &lt;body&gt;
       </strong>
      </span>
      <span>
       :
      </span>
      <pre class="source-code">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
  &lt;/head&gt;
  &lt;body ondragstart="return false"&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>
     </li>
     <li class="calibre14">
      Add a
      <strong class="source-inline1">
       &lt;div&gt;
      </strong>
      tag to the body and set its ID
      <span>
       as
      </span>
      <span>
       <strong class="source-inline1">
        map-canvas
       </strong>
      </span>
      <span>
       :
      </span>
      <pre class="source-code">
  &lt;body ondragstart="return false"&gt;
    &lt;div id="map-canvas" /&gt;
  &lt;/body&gt;</pre>
     </li>
     <li class="calibre14">
      Add the following code to the head of the
      <span>
       HTML document:
      </span>
      <pre class="source-code">
    &lt;meta name="viewport" content="initial-scale=1.0, userscalable=no" /&gt;
    &lt;style type="text/css"&gt;
    html { height: 100% }
    body { height: 100%; margin: 0; padding: 0 }
    #map-canvas { height: 100% }
    &lt;/style&gt;
    &lt;script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE&amp;libraries=drawing"&gt;&lt;/script&gt;</pre>
     </li>
     <li class="calibre14">
      Add the following code, also
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker884">
      </a>
      to the head of the HTML document, beneath the code we inserted in the
      <span>
       previous step:
      </span>
      <pre class="source-code">
    &lt;script type="text/javascript"&gt;
        var map;
        function initialize() {
// Add map
            var mapOptions =
            {
                center: new google.maps.LatLng(40.705311, -74.2581939), zoom: 6
            };
            map = new google.maps.Map(document.getElementById("mapcanvas"),mapOptions);
// Add event listener
            google.maps.event.addListener(map, 'zoom_changed',
   function() {
       //alert(map.getZoom());
            });</pre>
     </li>
     <li class="calibre14">
      Create a marker and
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker885">
      </a>
      place it on
      <span>
       the map:
      </span>
      <pre class="source-code">
// Add marker
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(40.705311, -74.2581939),
                map: map,
                title: "Marker A",
});
            google.maps.event.addListener (marker, 'click', function()
            {
                map.panTo(marker.getPosition());
            });
            marker.setMap(map);</pre>
     </li>
     <li class="calibre14">
      Add a polyline to
      <span>
       the map:
      </span>
      <pre class="source-code">
// Add polyline
            var points = [ new google.maps.LatLng(39.8543, -73.2183), new google.maps.LatLng(41.705311, -75.2581939), new google.maps.LatLng(40.62388, -75.5483) ];
            var polyOptions = {
            path: points,
            strokeColor: '#FF0000',
            strokeOpacity: 1.0,
            strokeWeight: 2
            };
            historyPolyline = new google.maps.Polyline(polyOptions);
            historyPolyline.setMap(map);</pre>
     </li>
     <li class="calibre14">
      Add a
      <span>
       polygon
      </span>
      <span>
       <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker886">
       </a>
      </span>
      <span>
       shape:
      </span>
      <pre class="source-code">
// Add polygon
            var points = [ new google.maps.LatLng(37.314166, -75.432), new google.maps.LatLng(40.2653, -74.4325), new google.maps.LatLng(38.8288, -76.5483) ];
                var polygon = new google.maps.Polygon({
                paths: points,
                fillColor: '#000000',
                fillOpacity: 0.2,
                strokeWeight: 3,
                strokeColor: '#fff000',
            });
            polygon.setMap(map);</pre>
     </li>
     <li class="calibre14">
      Create a drawing manager and apply it to
      <span>
       the map:
      </span>
      <pre class="source-code">
// Setup drawing manager
            var drawingManager = new google.maps.drawing.DrawingManager();
            drawingManager.setMap(map);
        }
        google.maps.event.addDomListener(window, 'load', initialize);
    &lt;/script&gt;</pre>
     </li>
     <li class="calibre14">
      Compile and run the project. You should see
      <span>
       the following:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer233">
      <img alt="Figure 13.16 – You should see a marker, a polyline, and a triangle on the Google map" class="calibre4" src="image/B20976_13_016.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.16 – You should see a marker, a polyline, and a triangle on the Google map
    </p>
    <h2 class="calibre7" id="_idParaDest-277">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor277">
     </a>
     How it works…
    </h2>
    <p class="calibre3">
     Google allows you to embed
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker887">
     </a>
     Google maps in a web page using its JavaScript library, called the
     <strong class="bold">
      Google Maps
     </strong>
     API. Through Qt’s
     <strong class="bold">
      WebEngine
     </strong>
     module, we can embed Google maps in our C++ project by loading an HTML file to our
     <strong class="source-inline">
      webview
     </strong>
     widget, which uses the
     <strong class="bold">
      Google Maps
     </strong>
     API. The only downside of this method is that we cannot load maps when there is no
     <span>
      internet connection.
     </span>
    </p>
    <p class="calibre3">
     The
     <strong class="bold">
      Google Maps
     </strong>
     API can be called by your website as Google allows it. Choose
     <a class="pcalibre pcalibre1 calibre6" href="https://console.developers.google.com">
      the free API if your plan is for
      <span>
       heav
      </span>
     </a>
     <span>
      ier traffic.
     </span>
    </p>
    <p class="calibre3">
     Go to
     <a class="pcalibre pcalibre1 calibre6" href="https://console.developers.google.com">
      https://console.developers.google.com
     </a>
     to get a free key and replace
     <strong class="source-inline">
      YOUR_KEY_HERE
     </strong>
     in the JavaScript source path with the API key you obtained
     <span>
      from Google.
     </span>
    </p>
    <p class="calibre3">
     We must define a
     <strong class="source-inline">
      &lt;div&gt;
     </strong>
     object, which serves as a container for the map. Then, when we initialize the map, we specify the ID of the
     <strong class="source-inline">
      &lt;div&gt;
     </strong>
     object so that the
     <strong class="bold">
      Google Maps
     </strong>
     API knows which HTML element to look for when embedding the map. By default, we set the center of the map to the coordinates of New York and set the default zoom level to 6. Then, we add an event listener that gets triggered when the zoom level of the
     <span>
      map changes.
     </span>
    </p>
    <p class="calibre3">
     Remove the double
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker888">
     </a>
     slashes (
     <strong class="source-inline">
      //
     </strong>
     ) from the code to see it in action. After that, we add a marker to the map through JavaScript. The marker also has an event listener attached to it, which will trigger the
     <strong class="source-inline">
      panTo()
     </strong>
     function when the marker
     <span>
      is clicked.
     </span>
    </p>
    <p class="calibre3">
     It basically pans the map view to the marker that has been clicked. Although we have added the drawing manager to the map (the icon buttons beside the
     <strong class="bold">
      Map
     </strong>
     and
     <strong class="bold">
      Satellite
     </strong>
     buttons), which allows users to draw any type of shape on top of the map, it’s also possible to add shapes manually using JavaScript, similar to how we added a marker in
     <em class="italic">
      step 12
     </em>
     , in the
     <em class="italic">
      How to do
     </em>
     <span>
      <em class="italic">
       it...
      </em>
     </span>
     <span>
      section.
     </span>
    </p>
    <p class="calibre3">
     Lastly, you may have noticed that headers are added to
     <strong class="source-inline">
      mainwindow.cpp
     </strong>
     instead of
     <strong class="source-inline">
      mainwindow.h
     </strong>
     . This is totally fine unless you are declaring class pointers in
     <strong class="source-inline">
      mainwindow.h
     </strong>
     —then, you have to include those headers
     <span>
      in it.
     </span>
    </p>
    <h1 class="calibre5" id="_idParaDest-278">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor278">
     </a>
     Calling C++ functions from JavaScript
    </h1>
    <p class="calibre3">
     In this recipe, we will learn
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker889">
     </a>
     how to put our knowledge to use and create a
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker890">
     </a>
     functional login screen using Qt
     <span>
      and SQLite.
     </span>
    </p>
    <h2 class="calibre7" id="_idParaDest-279">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor279">
     </a>
     How to do it…
    </h2>
    <p class="calibre3">
     Let’s learn how to call C++ functions from JavaScript using the
     <span>
      following steps:
     </span>
    </p>
    <ol class="calibre13">
     <li class="calibre14">
      Create a
      <strong class="bold">
       Qt Widgets Application
      </strong>
      project. Open the project file (
      <strong class="source-inline1">
       .pro
      </strong>
      ) and add the following modules to
      <span>
       the project:
      </span>
      <pre class="source-code">
QT += core gui <strong class="bold1">webenginewidgets</strong></pre>
     </li>
     <li class="calibre14">
      Open
      <strong class="source-inline1">
       mainwindow.ui
      </strong>
      and delete the
      <strong class="bold">
       mainToolBar
      </strong>
      ,
      <strong class="bold">
       menuBar
      </strong>
      , and
      <strong class="bold">
       statusBar
      </strong>
      objects, as we don’t need any of these in this
      <span>
       example program.
      </span>
     </li>
     <li class="calibre14">
      Add a vertical layout to the canvas, then select the canvas and click on the
      <strong class="bold">
       Lay Out Vertically
      </strong>
      button on top of
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker891">
      </a>
      the canvas. Add a text label to the top of the vertical layout and set its text to
      <strong class="source-inline1">
       Hello!
      </strong>
      . Make its font bigger by setting its
      <strong class="source-inline1">
       styleSheet
      </strong>
      property
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker892">
      </a>
      <span>
       as follows:
      </span>
      <pre class="source-code">
font: 75 26pt "MS Shell Dlg 2";</pre>
      <p class="calibre3">
       This is what it looks like after we applied the font properties to our
       <span>
        style sheet:
       </span>
      </p>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer234">
      <img alt="Figure 13.17 – Applying the font property to the “Hello!” text" class="calibre4" src="image/B20976_13_017.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.17 – Applying the font property to the “Hello!” text
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="4">
      Go to
      <strong class="bold">
       File
      </strong>
      |
      <strong class="bold">
       New File…
      </strong>
      and create a resource file. Add an empty HTML file and all the JavaScript files, CSS files, font files, and so on that belong to
      <strong class="bold">
       jQuery
      </strong>
      ,
      <strong class="bold">
       Bootstrap
      </strong>
      , and
      <strong class="bold">
       Font Awesome
      </strong>
      to your
      <span>
       project resources:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer235">
      <img alt="Figure 13.18 – Adding all the files to the project’s resource" class="calibre4" src="image/B20976_13_018.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.18 – Adding all the files to the project’s resource
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="5">
      Open your HTML file, which in
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker893">
      </a>
      this case is called
      <strong class="source-inline1">
       test.html
      </strong>
      . Link all the necessary JavaScript
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker894">
      </a>
      and CSS files to the HTML source code, between the
      <strong class="source-inline1">
       &lt;
      </strong>
      <span>
       <strong class="source-inline1">
        head&gt;
       </strong>
      </span>
      <span>
       tags:
      </span>
      <pre class="source-code">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;script src="qrc:///qtwebchannel/qwebchannel.js"&gt;&lt;/script&gt;
    &lt;script src="js/jquery.min.js"&gt;&lt;/script&gt;
    &lt;script src="js/bootstrap.js"&gt;&lt;/script&gt;
    &lt;link rel="stylesheet" type="text/css" href="css/bootstrap.css"&gt;
    &lt;link rel="stylesheet" type="text/css" href="css/fontawesome.css"&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
     </li>
     <li class="calibre14">
      Add the following
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker895">
      </a>
      JavaScript to the
      <strong class="source-inline1">
       &lt;head&gt;
      </strong>
      element, wrapped between the
      <strong class="source-inline1">
       &lt;
      </strong>
      <span>
       <strong class="source-inline1">
        script&gt;
       </strong>
      </span>
      <span>
       tags:
      </span>
      <pre class="source-code">
&lt;script&gt;
    $(document).ready(function()
    {
        new QWebChannel(qt.webChannelTransport,
function(channel)
        {
            mainWindow = channel.objects.mainWindow;
        });
        $("#login").click(function(e) {
            e.preventDefault();
            var user = $("#username").val();
            var pass = $("#password").val();
            mainWindow.showLoginInfo(user, pass);
        });</pre>
     </li>
     <li class="calibre14">
      Print
      <strong class="bold">
       Good bye!
      </strong>
      when
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker896">
      </a>
      clicking on the
      <strong class="bold">
       changeText
      </strong>
      button with the
      <span>
       following code:
      </span>
      <pre class="source-code">
        $("#changeText").click(function(e)
        {
            e.preventDefault();
            mainWindow.changeQtText("Good bye!");
        });
    });
&lt;/script&gt;</pre>
     </li>
     <li class="calibre14">
      Add the following
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker897">
      </a>
      code to the
      <strong class="source-inline1">
       &lt;
      </strong>
      <span>
       <strong class="source-inline1">
        body&gt;
       </strong>
      </span>
      <span>
       element:
      </span>
      <pre class="source-code">
    &lt;div class="container-fluid"&gt;
        &lt;form id="example-form" action="#" class="container-fluid"&gt;
            &lt;div class="form-group"&gt;
                &lt;div class="col-md-12"&gt;&lt;h3&gt;Call C++ Function from Javascript&lt;/h3&gt;&lt;/div&gt;
                &lt;div class="col-md-12"&gt;
                &lt;div class="alert alert-info" role="alert"&gt;&lt;i class="fa fa-info-circle"&gt;&lt;/i&gt;
            &lt;span id="infotext"&gt;Click "Login" to send username and password variables to C++. Click "Change Cpp Text" to change the text label on Qt GUI.&lt;/span&gt;
            &lt;/div&gt;
            &lt;/div&gt;</pre>
     </li>
     <li class="calibre14">
      Continuing from the previous code, this time, we create input fields for username and password, with
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker898">
      </a>
      two buttons at the bottom called
      <strong class="bold">
       Login
      </strong>
      and
      <strong class="bold">
       Change
      </strong>
      <span>
       <strong class="bold">
        Cpp Text
       </strong>
      </span>
      <span>
       :
      </span>
      <pre class="source-code">
            &lt;div class="col-md-12"&gt;&lt;label&gt;Username:&lt;/label&gt;&lt;input id="username" type="text"&gt;&lt;p /&gt;
            &lt;/div&gt;
            &lt;div class="col-md-12"&gt;
            &lt;label&gt;Password:&lt;/label&gt; &lt;input id="password" type="password"&gt;&lt;p /&gt;
            &lt;/div&gt;
            &lt;div class="col-md-12"&gt;
            &lt;button id="login" class="btn btn-success" type="button"&gt;&lt;i class="fa fa-check"&gt;&lt;/i&gt; Login&lt;/button&gt;
            &lt;button id="changeText" class="btn btn-primary" type="button"&gt;
            &lt;i class="fa fa-pencil"&gt;&lt;/i&gt; Change Cpp Text&lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/div&gt;</pre>
     </li>
     <li class="calibre14">
      Open
      <strong class="source-inline1">
       mainwindow.h
      </strong>
      and
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker899">
      </a>
      add the following public
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker900">
      </a>
      functions to the
      <span>
       <strong class="source-inline1">
        MainWindow
       </strong>
      </span>
      <span>
       class:
      </span>
      <pre class="source-code">
public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();
    <strong class="bold1">Q_INVOKABLE void changeQtText(QString newText);</strong>
    <strong class="bold1">Q_INVOKABLE void showLoginInfo(QString user, QString pass);</strong></pre>
     </li>
     <li class="calibre14">
      Open
      <strong class="source-inline1">
       mainwindow.cpp
      </strong>
      and add the following headers to the top of the
      <span>
       source code:
      </span>
      <pre class="source-code">
#include &lt;QtWebEngineWidgets/QWebEngineView&gt;
#include &lt;QtWebChannel/QWebChannel&gt;
#include &lt;QMessageBox&gt;</pre>
     </li>
     <li class="calibre14">
      Add the following code to the
      <span>
       <strong class="source-inline1">
        MainWindow
       </strong>
      </span>
      <span>
       constructor:
      </span>
      <pre class="source-code">
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    <strong class="bold1">qputenv("QTWEBENGINE_REMOTE_DEBUGGING", "1234");</strong>
    ui-&gt;setupUi(this);
    <strong class="bold1">QWebEngineView* webview = new QWebEngineView();</strong>
    <strong class="bold1">ui-&gt;verticalLayout-&gt;addWidget(webview);</strong>
    <strong class="bold1">QWebChannel* webChannel = new QWebChannel();</strong>
    <strong class="bold1">webChannel-&gt;registerObject("mainWindow", this);</strong>
    <strong class="bold1">webview-&gt;page()-&gt;setWebChannel(webChannel);</strong>
    <strong class="bold1">webview-&gt;page()-&gt;load(QUrl("qrc:///html/test.html"));</strong>
}</pre>
     </li>
     <li class="calibre14">
      Declare what
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker901">
      </a>
      happens when
      <strong class="source-inline1">
       changeQtText()
      </strong>
      and
      <strong class="source-inline1">
       showLoginInfo()
      </strong>
      <span>
       are called:
      </span>
      <pre class="source-code">
void MainWindow::changeQtText(QString newText) {
    ui-&gt;label-&gt;setText(newText);
}
void MainWindow::showLoginInfo(QString user, QString pass) {
    QMessageBox::information(this, "Login info", "Username is " + user + " and password is " + pass);
}</pre>
     </li>
     <li class="calibre14">
      Compile and run the program; you should see something similar to the following screenshot. If you
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker902">
      </a>
      click on the
      <strong class="bold">
       Change Cpp Text
      </strong>
      button, the word
      <strong class="bold">
       Hello!
      </strong>
      at the top will change to
      <strong class="bold">
       Goodbye!
      </strong>
      If you click on the
      <strong class="bold">
       Login
      </strong>
      button, a message box will appear and show you exactly what you typed in the
      <strong class="bold">
       Username
      </strong>
      and
      <strong class="bold">
       Password
      </strong>
      <span>
       input fields:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer236">
      <img alt="Figure 13.19 – Clicking on the buttons to call C++ functions" class="calibre4" src="image/B20976_13_019.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.19 – Clicking on the buttons to call C++ functions
    </p>
    <h2 class="calibre7" id="_idParaDest-280">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor280">
     </a>
     How it works…
    </h2>
    <p class="calibre3">
     In this example, we
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker903">
     </a>
     used two JavaScript libraries:
     <strong class="bold">
      jQuery
     </strong>
     and
     <strong class="bold">
      Bootstrap
     </strong>
     . We also used an iconic font package called
     <strong class="bold">
      Font Awesome
     </strong>
     . These third-party add-ons were used to make the HTML UI more interesting and responsive to different
     <span>
      screen resolutions.
     </span>
    </p>
    <p class="calibre3">
     We also used
     <strong class="bold">
      jQuery
     </strong>
     to detect
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker904">
     </a>
     the document’s ready status, as well as
     <a class="pcalibre pcalibre1 calibre6" href="https://jquery.com/download">
      to obtain the values of
      <span>
       in
      </span>
     </a>
     <span>
      put fields.
     </span>
    </p>
    <p class="callout-heading">
     Note
    </p>
    <p class="callout">
     You can
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker905">
     </a>
     download
     <strong class="bold">
      jQuery
     </strong>
     from
     <a class="pcalibre pcalibre1 calibre6" href="https://jquery.com/download">
      https://jquery.com/download
     </a>
     ,
     <strong class="bold">
      Bootstrap
     </strong>
     from
     <a class="pcalibre pcalibre1 calibre6" href="http://getbootstrap.com/getting-started/#download">
      http://getbootstrap.com/getting-started/#download
     </a>
     , and
     <strong class="bold">
      Font Awesome
     </strong>
     <span>
      from
     </span>
     <a class="pcalibre pcalibre1 calibre6" href="http://fontawesome.io">
      <span>
       http://fontawesome.io
      </span>
     </a>
     <span>
      .
     </span>
    </p>
    <p class="calibre3">
     Qt’s
     <strong class="bold">
      WebEngine
     </strong>
     module uses a mechanism called
     <strong class="bold">
      WebChannel
     </strong>
     , which enables
     <strong class="bold">
      peer-to-peer
     </strong>
     (
     <strong class="bold">
      P2P
     </strong>
     ) communication
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker906">
     </a>
     between the C++ program and the HTML page. The
     <strong class="bold">
      WebEngine
     </strong>
     module provides
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker907">
     </a>
     a JavaScript library that makes integration a lot easier. The JavaScript is
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker908">
     </a>
     embedded in your project’s resource by default, so you don’t need to import it into your project manually. You just have to include it in your HTML page by calling
     <span>
      the following:
     </span>
    </p>
    <pre class="source-code">
&lt;script src="qrc:///qtwebchannel/qwebchannel.js"&gt;&lt;/script&gt;</pre>
    <p class="calibre3">
     Once you have included
     <strong class="source-inline">
      qwebchannel.js
     </strong>
     , you can initialize the
     <strong class="source-inline">
      QWebChannel
     </strong>
     class and assign the Qt object we registered earlier in C++ to a
     <span>
      JavaScript variable.
     </span>
    </p>
    <p class="calibre3">
     In C++, this is done
     <span>
      as follows:
     </span>
    </p>
    <pre class="source-code">
QWebChannel* webChannel = new QWebChannel();
webChannel-&gt;registerObject("mainWindow", this);
webview-&gt;page()-&gt;setWebChannel(webChannel);</pre>
    <p class="calibre3">
     Then, in JavaScript, this is done
     <span>
      as follows:
     </span>
    </p>
    <pre class="source-code">
new QWebChannel(qt.webChannelTransport, function(channel) {
mainWindow = channel.objects.mainWindow;
});</pre>
    <p class="calibre3">
     You may be wondering what this
     <span>
      line means:
     </span>
    </p>
    <pre class="source-code">
qputenv("QTWEBENGINE_REMOTE_DEBUGGING", "1234");</pre>
    <p class="calibre3">
     Qt’s
     <strong class="bold">
      WebEngine
     </strong>
     module uses the remote debugging method to check for JavaScript errors and other problems. The number
     <strong class="source-inline">
      1234
     </strong>
     defines the port number you want to use for
     <span>
      remote debugging.
     </span>
    </p>
    <p class="calibre3">
     Once you have enabled remote debugging, you can access the debugging page by opening up a Chromium-based web browser, such as Google Chrome (this will not work in Firefox and other browsers), and typing in
     <strong class="source-inline">
      http://127.0.0.1:1234
     </strong>
     . You will then see a page that looks
     <span>
      like this:
     </span>
    </p>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer237">
      <img alt="Figure 13.20 – Inspectable pages allow you to debug more easily" class="calibre4" src="image/B20976_13_020.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.20 – Inspectable pages allow you to debug more easily
    </p>
    <p class="calibre3">
     The first page will display all HTML pages that are currently running in your program, which in this case is
     <strong class="source-inline">
      test.html
     </strong>
     . Click on the
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker909">
     </a>
     page link, and it will take you to another page for inspection. You
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker910">
     </a>
     can use this to check for CSS errors, JavaScript errors, and
     <span>
      missing files.
     </span>
    </p>
    <p class="calibre3">
     Note that you should disable remote debugging once your program is bug-free and ready for deployment. This is because remote debugging takes time to initialize and will increase your program’s
     <span>
      startup time.
     </span>
    </p>
    <p class="calibre3">
     If you want to call a C++ function from JavaScript, you must place the
     <strong class="source-inline">
      Q_INVOKABLE
     </strong>
     macro in front of the function’s declaration; otherwise, it will
     <span>
      not work:
     </span>
    </p>
    <pre class="source-code">
Q_INVOKABLE void changeQtText(QString newText);</pre>
    <h1 class="calibre5" id="_idParaDest-281">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor281">
     </a>
     Calling Javascript functions from C++
    </h1>
    <p class="calibre3">
     In the previous recipe, we learned how to
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker911">
     </a>
     call C++ functions from JavaScript through Qt’s
     <strong class="bold">
      WebChannel
     </strong>
     system. In this example, we will try to do the reverse: call
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker912">
     </a>
     JavaScript functions from
     <span>
      C++ code.
     </span>
    </p>
    <h2 class="calibre7" id="_idParaDest-282">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor282">
     </a>
     How to do it…
    </h2>
    <p class="calibre3">
     We can call JavaScript functions from C++ through the
     <span>
      following steps:
     </span>
    </p>
    <ol class="calibre13">
     <li class="calibre14">
      Create a new
      <strong class="bold">
       Qt Widgets Application
      </strong>
      project and add the
      <strong class="source-inline1">
       webenginewidgets
      </strong>
      module to
      <span>
       your project.
      </span>
     </li>
     <li class="calibre14">
      Open
      <strong class="source-inline1">
       mainwindow.ui
      </strong>
      and remove the
      <strong class="bold">
       mainToolBar
      </strong>
      ,
      <strong class="bold">
       menuBar
      </strong>
      , and
      <span>
       <strong class="bold">
        statusBar
       </strong>
      </span>
      <span>
       objects.
      </span>
     </li>
     <li class="calibre14">
      Add a vertical layout and a horizontal layout to the canvas. Select the canvas and click
      <strong class="bold">
       Lay Out Vertically
      </strong>
      . Make
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker913">
      </a>
      sure the horizontal layout is located at the bottom of the
      <span>
       vertical layout.
      </span>
     </li>
     <li class="calibre14">
      Add two push
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker914">
      </a>
      buttons to the horizontal layout; one is called
      <strong class="bold">
       Change HTML Text
      </strong>
      and the other is called
      <strong class="bold">
       Play UI Animation
      </strong>
      . Right-click on one of the buttons and click
      <strong class="bold">
       Go to slot…
      </strong>
      . A window will pop up and ask you to pick a signal. Select the
      <strong class="source-inline1">
       clicked()
      </strong>
      option and click
      <strong class="bold">
       OK
      </strong>
      . Qt will automatically add a slot function to your source code. Repeat this step for the
      <span>
       other button:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer238">
      <img alt="Figure 13.21 – Placing the buttons in the bottom layout" class="calibre4" src="image/B20976_13_021.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.21 – Placing the buttons in the bottom layout
    </p>
    <ol class="calibre13">
     <li class="calibre14" value="5">
      Open
      <strong class="source-inline1">
       mainwindow.h
      </strong>
      and add the following headers
      <span>
       to it:
      </span>
      <pre class="source-code">
#include &lt;QtWebEngineWidgets/QWebEngineView&gt;
#include &lt;QtWebChannel/QWebChannel&gt;
#include &lt;QMessageBox&gt;</pre>
     </li>
     <li class="calibre14">
      Declare the class pointer of a
      <strong class="source-inline1">
       QWebEngineView
      </strong>
      object
      <span>
       called
      </span>
      <span>
       <strong class="source-inline1">
        webview
       </strong>
      </span>
      <span>
       :
      </span>
      <pre class="source-code">
public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();
    <strong class="bold1">QWebEngineView* webview;</strong></pre>
     </li>
     <li class="calibre14">
      Open
      <strong class="source-inline1">
       mainwindow.cpp
      </strong>
      and add the
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker915">
      </a>
      following code to the
      <span>
       <strong class="source-inline1">
        MainWindow
       </strong>
      </span>
      <span>
       constructor:
      </span>
      <pre class="source-code">
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    <strong class="bold1">//qputenv("QTWEBENGINE_REMOTE_DEBUGGING", "1234");</strong>
    ui-&gt;setupUi(this);
    <strong class="bold1">webview = new QWebEngineView();</strong>
    <strong class="bold1">ui-&gt;verticalLayout-&gt;addWidget(webview);</strong>
    <strong class="bold1">QWebChannel* webChannel = new QWebChannel();</strong>
    <strong class="bold1">webChannel-&gt;registerObject("mainWindow", this);</strong>
    <strong class="bold1">webview-&gt;page()-&gt;setWebChannel(webChannel);</strong>
    <strong class="bold1">webview-&gt;page()-&gt;load(QUrl("qrc:///html/test.html"));</strong>
}</pre>
     </li>
     <li class="calibre14">
      Define what will happen when the
      <strong class="source-inline1">
       changeHtmlText
      </strong>
      button and the
      <strong class="source-inline1">
       playUIAnimation
      </strong>
      button
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker916">
      </a>
      <span>
       are clicked:
      </span>
      <pre class="source-code">
void MainWindow::on_changeHtmlTextButton_clicked() {
    webview-&gt;page()-&gt;runJavaScript("changeHtmlText('Text has been replaced by C++!');");
}
void MainWindow::on_playUIAnimationButton_clicked() {
    webview-&gt;page()-&gt;runJavaScript("startAnim();");
}</pre>
     </li>
     <li class="calibre14">
      Let’s create a resource file for our project by going to
      <strong class="bold">
       File
      </strong>
      |
      <strong class="bold">
       New File...
      </strong>
      . Select
      <strong class="bold">
       Qt Resource File
      </strong>
      under the
      <strong class="bold">
       Qt
      </strong>
      category and click
      <strong class="bold">
       Choose...
      </strong>
      . Insert your desired filename and click
      <strong class="bold">
       Next
      </strong>
      , followed
      <span>
       by
      </span>
      <span>
       <strong class="bold">
        Finish
       </strong>
      </span>
      <span>
       .
      </span>
     </li>
     <li class="calibre14">
      Add an empty HTML file and
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker917">
      </a>
      all the required add-ons (
      <strong class="bold">
       jQuery
      </strong>
      ,
      <strong class="bold">
       Bootstrap
      </strong>
      , and
      <strong class="bold">
       Font Awesome
      </strong>
      ) to the
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker918">
      </a>
      project resources. Add the
      <strong class="source-inline1">
       tux.png
      </strong>
      image file to the resources file as well, as we’ll be using it in a short while in
      <span>
       <em class="italic">
        step 14
       </em>
      </span>
      <span>
       .
      </span>
     </li>
     <li class="calibre14">
      Open the HTML file we just created and add it to the project resources; in our case, it’s called
      <strong class="source-inline1">
       test.html
      </strong>
      . Add the following HTML code to
      <span>
       the file:
      </span>
      <pre class="source-code">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;script src="qrc:///qtwebchannel/qwebchannel.js"&gt;&lt;/script&gt;
    &lt;script src="js/jquery.min.js"&gt;&lt;/script&gt;
    &lt;script src="js/bootstrap.js"&gt;&lt;/script&gt;
    &lt;link rel="stylesheet" type="text/css" href="css/bootstrap.css"&gt;
    &lt;link rel="stylesheet" type="text/css" href="css/fontawesome.css"&gt;
  &lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
     </li>
     <li class="calibre14">
      Add the following JavaScript code, which
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker919">
      </a>
      is wrapped within the
      <strong class="source-inline1">
       &lt;script&gt;
      </strong>
      tags, to the
      <strong class="source-inline1">
       &lt;head&gt;
      </strong>
      element
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker920">
      </a>
      of our
      <span>
       HTML file:
      </span>
      <pre class="source-code">
    &lt;script&gt;
      $(document).ready(function()
      {
        $("#tux").css({ opacity:0, width:"0%", height:"0%" });
        $("#listgroup").hide();
        $("#listgroup2").hide();
        new QWebChannel(qt.webChannelTransport,
  function(channel)
        {
          mainWindow = channel.objects.mainWindow;
        });
      });
      function changeHtmlText(newText)
      {
        $("#infotext").html(newText);
      }</pre>
     </li>
     <li class="calibre14">
      Define a
      <span>
       <strong class="source-inline1">
        startAnim()
       </strong>
      </span>
      <span>
       function:
      </span>
      <pre class="source-code">
      function startAnim() {
      // Reset
        $("#tux").css({ opacity:0, width:"0%", height:"0%" });
        $("#listgroup").hide();
        $("#listgroup2").hide();
        $("#tux").animate({ opacity:1.0, width:"100%",
height:"100%" }, 1000, function()
        {
// tux animation complete
          $("#listgroup").slideDown(1000, function() {
          // listgroup animation complete
            $("#listgroup2").fadeIn(1500);
          });
        });
    }
&lt;/script&gt;</pre>
     </li>
     <li class="calibre14">
      Add the following
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker921">
      </a>
      code to the
      <strong class="source-inline1">
       &lt;body&gt;
      </strong>
      element of our
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker922">
      </a>
      <span>
       HTML file:
      </span>
      <pre class="source-code">
  &lt;div class="container-fluid"&gt;
    &lt;form id="example-form" action="#" class="container-fluid"&gt;
      &lt;div class="form-group"&gt;
      &lt;div class="col-md-12"&gt;&lt;h3&gt;Call Javascript Function from C++&lt;/h3&gt;&lt;/div&gt;
      &lt;div class="col-md-12"&gt;
      &lt;div class="alert alert-info" role="alert"&gt;&lt;i class="fa fa-info-circle"&gt;&lt;/i&gt; &lt;span id="infotext"&gt; Change this text using C++.&lt;/span&gt;&lt;/div&gt;
      &lt;/div&gt;
      &lt;div class="col-md-2"&gt;
        &lt;img id="tux" src="tux.png"&gt;&lt;/img&gt;
      &lt;/div&gt;</pre>
     </li>
     <li class="calibre14">
      Continue writing the
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker923">
      </a>
      following code, to which we’ve
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker924">
      </a>
      added
      <span>
       a list:
      </span>
      <pre class="source-code">
      &lt;div class="col-md-5"&gt;
        &lt;ul id="listgroup" class="list-group"&gt;
        &lt;li class="list-group-item"&gt;Cras justoodio&lt;/li&gt;
        &lt;li class="list-group-item"&gt;Dapibus acfacilisis in&lt;/li&gt;
        &lt;li class="list-group-item"&gt;Morbi leorisus&lt;/li&gt;
        &lt;li class="list-group-item"&gt;Porta acconsectetur ac&lt;/li&gt;
        &lt;li class="list-group-item"&gt;Vestibulum ateros&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/div&gt;
      &lt;div id="listgroup2" class="col-md-5"&gt;
        &lt;a href="#" class="list-group-item active"&gt;
        &lt;h4 class="list-group-item-heading"&gt;Item heading&lt;/h4&gt;
        &lt;p class="list-group-item-text"&gt;Cras justo odio&lt;/p&gt;
        &lt;/a&gt;</pre>
     </li>
     <li class="calibre14">
      The code continues as
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker925">
      </a>
      we add the remaining items to a
      <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker926">
      </a>
      <span>
       second list:
      </span>
      <pre class="source-code">
        &lt;a href="#" class="list-group-item"&gt;
          &lt;h4 class="list-group-item-heading"&gt;Item heading&lt;/h4&gt;
          &lt;p class="list-group-item-text"&gt;Dapibus ac facilisis in&lt;/p&gt;
        &lt;/a&gt;
        &lt;a href="#" class="list-group-item"&gt;
          &lt;h4 class="list-group-item-heading"&gt;Item heading&lt;/h4&gt;
          &lt;p class="list-group-item-text"&gt;Morbi leo risus&lt;/p&gt;
        &lt;/a&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/form&gt;
&lt;/div&gt;</pre>
     </li>
     <li class="calibre14">
      Build and run the program; you should get a similar result to that in the following screenshot. When you click on the
      <strong class="bold">
       Change HTML Text
      </strong>
      button, the information text is located within the top panel. If you click on the
      <strong class="bold">
       Play UI Animation
      </strong>
      button, penguin images, alongside the two sets of widgets, will appear one after the other, with
      <span>
       different animations:
      </span>
     </li>
    </ol>
    <div class="calibre2">
     <div class="img---figure" id="_idContainer239">
      <img alt="Figure 13.22 – Clicking on the buttons at the bottom to see the results" class="calibre4" src="image/B20976_13_022.jpg"/>
     </div>
    </div>
    <p class="img---caption" lang="en-US" xml:lang="en-US">
     Figure 13.22 – Clicking on the buttons at the bottom to see the results
    </p>
    <h2 class="calibre7" id="_idParaDest-283">
     <a class="pcalibre pcalibre1 calibre6" id="_idTextAnchor283">
     </a>
     How it works…
    </h2>
    <p class="calibre3">
     This example is similar to the
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker927">
     </a>
     previous one in the
     <em class="italic">
      Calling C++ functions from JavaScript
     </em>
     recipe. Once we have included the
     <strong class="bold">
      WebChannel
     </strong>
     JavaScript library and initiated the
     <strong class="source-inline">
      QWebChannel
     </strong>
     class, we can call any of the JavaScript functions from C++ by calling
     <strong class="source-inline">
      webview-&gt;page()-&gt;runJavascript("jsFunctionNameHere();")
     </strong>
     . Don’t forget to apply the web channel created in C++ to
     <strong class="source-inline">
      webview
     </strong>
     page as well; otherwise, it will not be able to communicate with the
     <strong class="source-inline">
      QWebChannel
     </strong>
     class in your
     <span>
      HTML file.
     </span>
    </p>
    <p class="calibre3">
     By default, we change the CSS properties of the penguin image and set its opacity to 0, width to 0%, and height to 0%. We also hide the two list groups by calling the
     <strong class="source-inline">
      hide()
     </strong>
     <strong class="bold">
      jQuery
     </strong>
     function. When the
     <strong class="bold">
      Play UI Animation
     </strong>
     button is clicked, we repeat the steps just in case the animations have
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker928">
     </a>
     been played before (that is, the same button has been clicked before), and then we hide the list groups again in order for the animations to
     <span>
      be replayed.
     </span>
    </p>
    <p class="calibre3">
     One powerful feature of
     <strong class="bold">
      jQuery
     </strong>
     is that you can define what happens after an animation finishes, which allows us to play animations in sequence. In this example, we started with the penguin image and interpolated its CSS properties to a targeted setting within a second (1,000 milliseconds). Once that was done, we started another animation, which made the first list group slide from top to bottom in 1 second. After that, we ran the third animation, which made the second
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker929">
     </a>
     list group fade in from nowhere within
     <span>
      1.5 seconds.
     </span>
    </p>
    <p class="calibre3">
     To replace the information
     <a class="pcalibre pcalibre1 calibre6" id="_idIndexMarker930">
     </a>
     text located in the top panel, we created a JavaScript function called
     <strong class="source-inline">
      changeHtmlText()
     </strong>
     within the function itself, and we got the HTML element by referring to its ID and calling
     <strong class="source-inline">
      html()
     </strong>
     to change
     <span>
      its contents.
     </span>
    </p>
   </div>
  </div>
 </body>
</html>
